---
title: Express.js
description: Adapter for integrating with Express.js
sidebar_position: 5
---

import PackageInstall from '../../_components/PackageInstall';
import ErrorHandling from './_error-handling.md';
import Intro from './_intro.mdx';
import AdapterOptions from './_options.mdx';

# Express.js Adapter

<Intro module='@zenstackhq/server/express' framework='Express.js' url="https://expressjs.com/" />

### Installation

<PackageInstall dependencies={['@zenstackhq/server@next']} />

### Mounting the API

You can integrate ZenStack into your project with the `ZenStackMiddleware` [express middleware](https://expressjs.com/en/guide/using-middleware.html):

```ts
import express from 'express';
import { ZenStackMiddleware } from '@zenstackhq/server/express';
import { RPCApiHandler } from '@zenstackhq/server/api';
import { getSessionUser } from '~/auth';
import { client } from '~/db';
import { schema } from '~/zenstack/schema';

const app = express();

app.use(express.json());

app.use(
    '/api/model',
    ZenStackMiddleware({
        apiHandler: new RPCApiHandler({ schema }),
        // getSessionUser extracts the current session user from the request, its
        // implementation depends on your auth solution
        getClient: (request) => client.$setAuth(getSessionUser(request)),
    })
);
```

The Express.js adapter takes the following options to initialize:

<AdapterOptions getClient='(request: Request, response: Response) => ClientContract<Schema> | Promise<ClientContract<Schema>>' />

- sendResponse (optional)

    <blockquote>boolean</blockquote>

    Controls if the middleware directly sends a response. If set to false, the response is stored in the `res.locals` object and then the middleware calls the `next()` function to pass the control to the next middleware. Subsequent middleware or request handlers need to make sure to send a response.
    
    Defaults to `true`.

<ErrorHandling />
