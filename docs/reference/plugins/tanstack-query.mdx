---
description: Plugin for generating Tanstack Query query and mutation hooks
sidebar_position: 6
---

# @zenstackhq/tanstack-query

:::info
This package is in preview stage and will supersede [`@zenstackhq/react`](/docs/reference/plugins/react) plugin in the future.

If you're looking for generating hooks for [SWR](https://swr.vercel.app/), please checkout the [`@zenstackhq/swr`](/docs/reference/plugins/swr) plugin.
:::

The `@zenstack/tanstack-query` plugin generates [Tanstack Query](https://tanstack.com/query/latest) hooks that call into the CRUD services provided by the [server adapters](/docs/category/server-adapters). The plugin currently supports React and Svelte. Vue support is coming soon.

The hooks syntactically mirror the APIs of a standard Prisma client, including the function names and shapes of parameters (hooks directly use types generated by Prisma).

To use the generated hooks, you need to install "tanstack-query" for the target framework with version 4.0.0 or above.

## Options

| Name    | Type   | Description                                             | Required | Default |
| ------- | ------ | ------------------------------------------------------- | -------- | ------- |
| output  | String | Output directory (relative to the path of ZModel)                                        | Yes      |         |
| target  | String | Target framework to generate for. Choose from "react" and "svelte".                                        | Yes      |         |
| useSuperJson  | Boolean | Use [superjson](https://github.com/blitz-js/superjson) for data serialization                                        | No      | false        |

## Example

Here's a quick example with a ReactJs blogging app. You can find a fully functional Todo app example [here](https://github.com/zenstackhq/sample-todo-nextjs-tanstack).

### Schema

```prisma title='/schema.zmodel'
plugin hooks {
  provider = '@zenstackhq/tanstack-query'
  output = "./src/lib/hooks"
  target = "react"
}

model User {
  id            String    @id @default(cuid())
  email         String
  posts         Post[]

  // everyone can signup, and user profile is also publicly readable
  @@allow('create,read', true)
}

model Post {
  id        String @id @default(cuid())
  title     String
  published Boolean @default(false)
  author    User @relation(fields: [authorId], references: [id])
  authorId  String

  // author has full access
  @@allow('all', auth() == author)

  // logged-in users can view published posts
  @@allow('read', auth() != null && published)
}
```

### Component

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
<TabItem value="tsx" label="React">

```tsx title='/src/components/Posts.tsx'
import type { Post } from '@prisma/client';
import { useFindManyPost, useCreatePost } from '../lib/hooks';

// post list component
const Posts = ({ userId }: { userId: string }) => {
    const create = useCreatePost();

    // list all posts that're visible to the current user, together with their authors
    const { data: posts } = useFindManyPost({
        include: { author: true },
        orderBy: { createdAt: 'desc' },
    });

    async function onCreatePost() {
        create.mutate({
            data: {
                title: 'My awesome post',
                authorId: userId,
            },
        });
    }

    return (
        <>
            <button onClick={onCreatePost}>Create</button>
            <ul>
                {posts?.map((post) => (
                    <li key={post.id}>
                        {post.title} by {post.author.email}
                    </li>
                ))}
            </ul>
        </>
    );
};
```

</TabItem>

<TabItem value="svelte" label="Svelte">

```svelte title='/src/components/Posts.svelte'
<script lang="ts">
    import type { Post } from '@prisma/client';
    import { useFindManyPost, useCreatePost } from '../lib/hooks';

    export let userId: string;

    const posts = useFindManyPost();
    const create = useCreatePost();

    function onCreatePost() {
        $create.mutate({
            data: {
                title: 'My awesome post',
                authorId: userId,
            },
        });
    }
</script>

<div>
    <button on:click={onCreatePost}>Create</button>
    <ul>
        {#each $posts as post (post.id))}
            <li>{post.title} by {post.author.email}</li>
        {/each}
    </ul>
</div>
```

</TabItem>
</Tabs>